\documentclass{standalone}
\usepackage{mintikz}

% \toggletrue{student}
% \toggletrue{corrige}

\settype{prof}
\settype{stud}

\tdplotsetmaincoords{70}{110}

\begin{document}
\begin{tikzpicture}[scale=1,tdplot_main_coords]
	\coordinate (O) at (0,0,0);
	\node[anchor=south east] at (O) {O};
	% draw axes
	\draw[very thick,-stealth] (0,0,0) -- (6,0,0) node[anchor=north east]{$x$};
	\draw[very thick,-stealth] (0,0,0) -- (0,6,0) node[anchor=north west]{$y$};
	\draw[very thick,-stealth] (0,0,0) -- (0,0,6) node[anchor=south]{$z$};
	% draw ux uy uz
	\draw[very thick,-stealth] (0,0,0) -- (1,0,0) node[anchor=east]{$\ux$};
	\draw[very thick,-stealth] (0,0,0) -- (0,1,0) node[anchor=south east]{$\uy$};
	\draw[very thick,-stealth] (0,0,0) -- (0,0,1) node[anchor=east]{$\uz$};
	% theta
	\def\tht{50}
	\def\pht{50}
	% set point
	\def\rM{5}
	\tdplotsetcoord{M}{\rM}{\pht}{\tht}
	\tdplotsetcoord{Mr}{\rM+1}{\pht}{\tht}
	% draw a vector from origin to point (M)
	\draw[very thick, -stealth, myred]
	(O) -- (M)
	node[pos=.75, below, sloped]
	{$r(t)$}
	node[left=.4]
	{$\mathrm{M}(t)$};
	% draw partial sphere
	\tdplotdrawarc[thick] {(O)}{\rM}{0}{90}{}{}
	\tdplotsetthetaplanecoords{0}
	\tdplotdrawarc[thick, tdplot_rotated_coords]{(O)}{\rM}{0}{90}{}{}
	\tdplotsetthetaplanecoords{90}
	\tdplotdrawarc[thick, tdplot_rotated_coords]{(O)}{\rM}{0}{90}{}{}
	\tdplotsetthetaplanecoords{\pht}
	\tdplotdrawarc[thick, dotted, tdplot_rotated_coords]{(O)}{\rM}{0}{90}{}{}
	\tdplotdrawarc[thick, dotted]{(Mz)}{{\rM*sin(\tht)}}{0}{90}{}{}
	% xy projection
	\coordinate(H) at (Mxy);
	\node[below left, myred] at (H) {$\mathrm{H}(t)$};
	\draw[thick, dashed, myblue]
	(H) -- (M)
	node[midway, below, sloped, \sswitch{white}{myblue}] {$r \cos(\th)$}
	;
	% z projection
	\draw[thick, dashed, myblue]
	(M) -- (Mz)
	node[left, black] {$z(t)$}
	node[midway, above, sloped, \sswitch{white}{myblue}] {$r \sin(\th)$}
	;
	% x projection
	\draw[thick, dashed]
	(H) -- (Mx)
	node[left] {$x(t)$}
	;
	% y projection
	\draw[thick, dashed]
	(H) -- (My)
	node[above right] {$y(t)$}
	;
	% rayon
	\draw[thick, dashed, myred, -stealth, canvas is xy plane at z=0]
	(O) -- (H);
	% right angle of theta
	\draw
	pic[draw, thick, angle radius=5, angle eccentricity=1.3]
		{right angle=O--Mz--M};
	\draw
	pic[draw, thick, angle radius=5, angle eccentricity=1.3]
		{right angle=M--H--O};
	% right angle of phi
	\draw
	pic[draw, thick, angle radius=5, angle eccentricity=1.3]
		{right angle=O--Mx--H};
	\draw
	pic[draw, thick, angle radius=5, angle eccentricity=1.3]
		{right angle=O--My--H};
	% draw ur ut uz
	\tdplotsetrotatedcoords{\pht}{\tht}{0}
	\draw[very thick, -stealth, mypurple,tdplot_rotated_coords] (M) --++
	(1,0,0) coordinate (T)
	node[anchor=west]{$\ut$};
	\draw[very thick, -stealth, mypurple,tdplot_rotated_coords] (M) --++
	(0,1,0) coordinate (F)
	node[anchor=west]{$\uf$};
	\draw[very thick, -stealth, mypurple,tdplot_rotated_coords] (M) --++
	(0,0,1) coordinate (R)
	node[anchor=south]{$\ur$};
	% draw rightangle
	\draw
	pic[draw, thick, angle radius=5, angle eccentricity=1.3]
		{right angle=F--M--T};
	\draw
	pic[draw, thick, angle radius=5, angle eccentricity=1.3]
		{right angle=F--M--R};
	\ifprof{%
		% draw arc
		\tdplotsetthetaplanecoords{\pht}
		\tdplotdrawarc[thick, -stealth, mygreen, tdplot_rotated_coords]
		{(O)}{1.5}{0}{\tht}{anchor=west}{$\th(t)$}
		\tdplotdrawarc[thick, -stealth, mygreen, tdplot_rotated_coords]
		{(O)}{2.5}{90}{\tht}{anchor=west}{$\lambda(t)$}
		\tdplotdrawarc[thick, -stealth, mygreen]
		{(O)}{2.5}{0}{\pht}{anchor=north}{$\f(t)$}
	}%
	% bullet above all
	\node[myred] at (H) {$\bullet$};
	\node[myred] at (M) {$\bullet$};
\end{tikzpicture}
\end{document}
